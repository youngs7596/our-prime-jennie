# Session Handoff: Oracle/OCI 레거시 코드 전면 제거

## 요약 (Summary)
저장소 전체에서 Oracle DB 관련 레거시 코드를 완전히 제거했습니다. 환경변수, 시크릿 참조, DB 연결 분기 로직, Oracle 전용 SQL(MERGE INTO, FROM DUAL, SYSTIMESTAMP, ALTER SESSION) 등 28개 파일에서 952줄 삭제, MariaDB/SQLAlchemy 단일 체계로 통일했습니다.

## 변경 사항 (Changes)

### 서비스 초기화 (Oracle wallet/시크릿 분기 제거)
- `services/command-handler/main.py`: Oracle 시크릿 로딩 제거, `database.init_connection_pool()` 단일화
- `services/daily-briefing/main.py`: 동일 패턴 정리
- `services/news-crawler/crawler.py`: OCI 환경변수 참조 제거
- `services/daily-briefing/check_db_status.py`: Oracle 분기 제거

### 스크립트 (get_db_config + **db_config 패턴 제거)
- `scripts/collect_full_market_data_parallel.py`: Oracle MERGE/ALTER SESSION 제거, MariaDB UPSERT만 유지
- `scripts/collect_dart_filings.py`: Oracle DDL/CREATE TABLE 분기 제거
- `scripts/collect_naver_news.py`: 동일 패턴 정리
- `scripts/collect_quarterly_financials.py`: Oracle MERGE/DUAL/ROWNUM 제거
- `scripts/collect_investor_trading.py`: Oracle DDL 분기 제거
- `scripts/tag_news_sentiment.py`: get_db_config() 함수 제거
- `scripts/run_factor_analysis.py`: Oracle 시크릿 로딩 제거

### 유틸리티 (Oracle DDL/MERGE 완전 제거)
- `utilities/update_stock_master.py`: Oracle DDL/MERGE INTO/SYSTIMESTAMP 전면 제거, MariaDB 전용으로 단순화
- `utilities/data_collector.py`: Oracle MERGE/user_tables 조회 → MariaDB 방식으로 변경
- `utilities/naver_finance_scraper.py`: Oracle MERGE 제거, MariaDB INSERT ON DUPLICATE KEY UPDATE로 통일

### shared 모듈
- `shared/hybrid_scoring/schema.py`: `is_oracle()` import/분기 제거
- `shared/hybrid_scoring/factor_analyzer.py`: `_is_mariadb()` 함수 → 항상 True 반환, Oracle 주석 정리
- `shared/financial_data_collector.py`: DB_TYPE 기본값 MARIADB로 변경
- `shared/database/trading.py`: WatchList/Portfolio/TradeLog 테이블명 통일, Oracle TO_DATE 분기 제거
- `shared/db/connection.py`: DB_TYPE 기본값 MARIADB 명시, Oracle 관련 주석 정리
- `shared/auth.py`: Oracle 시크릿 ID 상수 주석 처리

## 검증 결과
- ✅ Oracle 환경변수/시크릿 참조: 0건
- ✅ `get_db_connection(**db_config)` 패턴: 0건
- ✅ Oracle SQL 문법(MERGE INTO, FROM DUAL 등): 프로젝트 코드에 0건
- ✅ DB_TYPE 기본값 ORACLE: 0건
- ✅ 핵심 모듈 import 테스트: 성공
- ✅ 수정된 16개 파일 py_compile: 모두 통과

## 다음 단계 (Next Steps)
- [ ] Docker 환경에서 전체 서비스 재시작 후 정상 동작 확인
- [ ] Scout/Hunter/Buy-Executor 파이프라인 E2E 테스트
- [ ] (Optional) 테스트 파일(`tests/shared/hybrid_scoring/test_schema.py`)의 Oracle 관련 주석 정리

## Context for Next Session
- `shared/database/trading.py`: WatchList/Portfolio/TradeLog 조회/저장 로직
- `shared/db/connection.py`: MariaDB 연결 핵심 모듈
- `utilities/update_stock_master.py`: 종목 마스터 업데이트 스크립트








