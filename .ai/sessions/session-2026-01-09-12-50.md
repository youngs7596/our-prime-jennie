# Session Handoff: Sell Logic Refinement & CI Stabilization

## 요약 (Summary)
RSI 과열 매도 시의 낮은 수익성 문제를 해결하기 위해 3% 최소 수익률 가드라인을 도입하고, 분할 매도 후 시스템이 종목 추적을 놓치는 중대한 버그를 수정했습니다. 또한 Jenkins CI 빌드 실패(테스트 탐색 오류)를 해결하여 배포 안정성을 확보했습니다.

## 변경 사항 (Changes)
- **services/price-monitor/monitor.py**: 
  - RSI 과열 매도 시 3% 최소 수익률(`SELL_RSI_MIN_PROFIT_PCT`) 조건 추가.
  - 분할 매도 시 종목을 `portfolio_cache`에서 제거하지 않고 수량만 업데이트하여 지속 모니터링 보장.
  - Redis를 이용한 세션 내 RSI 중복 매도 방지 로직(`get_rsi_overbought_sold`) 구현.
- **shared/redis_cache.py**: 
  - RSI 매도 상태 추적을 위한 `get_rsi_overbought_sold`, `set_rsi_overbought_sold`, `delete_rsi_overbought_sold` 함수 추가.
- **shared/db/repository.py**: 
  - `get_active_portfolio`에서 `PARTIAL`(분할 매수/매도 진행 중) 상태인 종목도 포함하도록 쿼리 수정.
- **Jenkinsfile**: 
  - Unit Test 단계를 `pytest`에서 `unittest discover`로 전환하여 메모리 고갈 문제 해결.
  - Python 버전을 `3.12-slim`으로 단일화하고 `pip install` 캐시 활용 최적화.
- **Tests**: 
  - `tests/` 하위 디렉토리에 누락된 `__init__.py` 파일을 생성하여 `unittest` 자동 탐색이 가능하도록 조치.

## 다음 단계 (Next Steps)
- **CI 테스트 정상화**: 현재 `unittest discover`로 탐색은 성공했으나, 여전히 일부 Mock 오염 및 환경 설정 문제로 실패하는 테스트(7개 Fail, 8개 Error)들이 존재합니다. 다음 세션에서 이를 하나씩 격리하여 수정해야 합니다.
- **RSI 매도 실전 검증**: 최소 수익률 3% 가드라인이 실제 장에서 의도대로 작동하는지 텔레그램 알림을 통해 모니터링이 필요합니다.
- **Partial Status 통합**: 대시보드의 다른 페이지들에서도 `PARTIAL` 상태 종목이 `HOLDING`과 동일하게 취급되어 시각화되는지 전수 조사가 필요합니다.
