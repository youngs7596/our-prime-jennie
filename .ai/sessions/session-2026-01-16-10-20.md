# Session Handoff: Price-Monitor Modernization & Architecture Completion

## 요약 (Summary)
이번 세션에서는 `buy-scanner`에 이어 `price-monitor` 서비스까지 **Redis Streams 기반의 완전한 이벤트 구동 아키텍처**로 전환을 완료했습니다. 이제 두 핵심 서비스 모두 `kis-gateway`가 발행하는 `kis:prices` 스트림을 소비하며, 레거시 폴링(Scheduler) 및 WebSocket 직결 로직이 모두 제거되었습니다. 또한, 단위 테스트(`test_monitor.py`)를 최신화하여 변경된 로직의 정합성을 검증했습니다.

## 변경 사항 (Changes)
- **`services/price-monitor/main.py`**:
  - Scheduler Worker 및 폴링 트리거 로직 완전 제거.
  - 서비스 초기화 로직을 Redis Streams 전용으로 단순화.
- **`services/price-monitor/monitor.py`**:
  - `_monitor_with_polling`, `_monitor_with_websocket` 메서드 삭제.
  - `start_monitoring`에서 `REDIS_STREAMS_AVAILABLE` 확인 및 강제.
- **`tests/services/price-monitor/test_monitor.py`**:
  - 레거시 테스트 케이스 제거 및 Redis Streams 소비 로직 모의(Mock) 테스트 보강.
  - 무한 루프 방지 로직(`stop_event` mocking) 적용.
- **`tests/services/price-monitor/test_opportunity_watcher.py`**:
  - `buy-scanner`로 기능 이관됨에 따라 불필요한 테스트 파일 삭제.
- **`docs/changelogs/CHANGELOG-2026-01.md`**:
  - 2026-01-16 작업 내역(Price-Monitor Modernization) 추가.

## 다음 단계 (Next Steps)
- [ ] **Sell Logic Enhancement**: 호황장 변동성에 대비한 매도 로직의 즉시성 및 무결성(Redis Lock) 재검토.
- [ ] **Shared Utils Cleanup**: 스케줄러 및 폴링 제거로 인해 더 이상 사용되지 않는 `shared/scheduler_runtime.py` 등의 레거시 코드 정리.
- [ ] **E2E Validation**: 변경된 아키텍처 상에서 전체 매수-매도 파이프라인 통합 테스트 수행.
