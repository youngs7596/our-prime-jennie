# Session Handoff: Backfill 안정화 및 매도 로직 실전 일치

## 요약 (Summary)
- 백테스트 매도 로직을 Price Monitor 기준으로 맞추고 DYNAMIC_STOP을 제거해 실전과 정합성을 높였습니다.
- 운영 설정값(DB Config)을 백테스트가 읽도록 연결해 일일 매수 한도와 손절/익절 비율을 실전과 동일하게 적용했습니다.
- LLM 결정 소스 분석 결과 손절의 대부분이 FACTOR_SCORE(LLM 결재 없음)에서 발생함을 확인했습니다.
- backfill_scout_real.py를 재작성하여 거래일 기준/유니버스 확장/레짐 반영/단일 배치 처리를 지원하고 인덴트 및 패치 복원 오류를 수정했습니다.

## 변경 사항 (Changes)
- `utilities/backtest_gpt_v2.py`: 매도 로직을 Price Monitor 기준으로 정렬, DYNAMIC_STOP 제거, 운영 설정값 기반 매도 정책 적용.
- `utilities/backtest_scout_e2e.py`: 운영 설정값 반영(매수 한도/손절/익절/비중), LLM 소스 우선순위 정리, 매도 정책 연동.
- `utilities/analyze_backtest_loss_sources.py`: 손절/전체 매도 소스 분포 분석 확장, DB 접속 옵션 추가.
- `utilities/backfill_scout_real.py`: 거래일 캘린더 기반 루프, 유니버스/후보 수 파라미터화, 레짐 반영, 단일 프로세스 배치, 중복 스킵 옵션, 인덴트/복원 오류 수정.

## 다음 단계 (Next Steps)
- 개선된 `backfill_scout_real.py`로 2025-07~2026-01 재백필 실행(유니버스 200, 단일 프로세스).
- 백필 완료 후 백테스트 재실행 및 FACTOR_SCORE 의존도/손절 비중 재측정.
- 필요 시 LLM_DECISION_LEDGER/ WATCHLIST_HISTORY 커버리지 점검 및 추가 백필.

