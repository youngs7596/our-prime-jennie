# Session Handoff: Config/Secrets UI & Mock Test Switches

## 요약 (Summary)
- 설정 관리 단순화 1차 완료: 레지스트리에 민감 키 추가, 시크릿 값 마스킹, SecretManager 분리, 대시보드 Settings에서 시크릿을 표시하되 값은 비공개.
- Mock/테스트용 장운영 체크 스킵 플래그(`DISABLE_MARKET_OPEN_CHECK`, `TRADING_MODE=MOCK`)를 scout-job, buy-scanner, news-crawler에 적용해 휴장 시간에도 플로우를 돌릴 수 있게 함.

## 변경 사항 (Changes)
- `shared/settings/registry.py`: 시크릿 키에 `sensitive` 메타 추가.
- `shared/secret_manager.py`: env > secrets.json 기반 시크릿 조회 유틸 신규.
- `services/dashboard/backend/routers/configs.py`: 시크릿 키 마스킹, source=secret 표기, 편집 차단.
- `services/dashboard/frontend/src/pages/Settings.tsx`: 시크릿 키 값 마스킹, 잠금 배지/소스 뱃지(`secret(env|file|unset)`).
- `services/scout-job/scout.py`, `services/buy-scanner/main.py`, `services/news-crawler/crawler.py`: `DISABLE_MARKET_OPEN_CHECK` 또는 `TRADING_MODE=MOCK` 시 장운영 체크 스킵.

## 다음 단계 (Next Steps)
- [ ] Mock 모드 통합 테스트: `TRADING_MODE=MOCK`, `DRY_RUN=true`, `DISABLE_MARKET_OPEN_CHECK=true`로 뉴스 수집 → Scout → Scanner → Executor 로그 확인.
- [ ] REAL 모드 전환 전, `DISABLE_MARKET_OPEN_CHECK` 해제 및 장운영 체크 복구 확인.
- [ ] 대시보드 Settings에서 시크릿 키가 마스킹/잠금으로 표시되는지 UI 확인.

## Context for Next Session
- `services/dashboard/backend/routers/configs.py` (시크릿 마스킹 로직)
- `services/dashboard/frontend/src/pages/Settings.tsx` (시크릿 UI 표시/잠금)
- `shared/secret_manager.py` (시크릿 로딩)
- `services/scout-job/scout.py`, `services/buy-scanner/main.py`, `services/news-crawler/crawler.py` (market open 체크 스킵 플래그)

## 핵심 결정사항 (Key Decisions)
- 시크릿은 env/secrets.json만 사용하고 DB에는 저장/노출하지 않음. UI에는 존재 여부만 표시, 값은 항상 마스킹.
- Mock/테스트 편의를 위해 `DISABLE_MARKET_OPEN_CHECK` 플래그를 추가해 휴장 시간에도 파이프라인을 실행 가능하도록 함.

## 주의사항 (Warnings)
- REAL 모드에서는 `DISABLE_MARKET_OPEN_CHECK`를 반드시 해제해야 함.
- 시크릿 키는 여전히 env/secrets.json에서만 설정 가능하며 DB나 UI로 수정할 수 없음.***



